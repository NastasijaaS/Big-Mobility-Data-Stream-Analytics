version: "3"
services:
  spark:
    container_name: spark-master-x
    image: docker.io/bitnami/spark:latest
    environment:
      - SPARK_MODE=master
      - SPARK_UI_PORT=4040  
      - SPARK_MASTER_WEBUI_PORT=4040 
    ports:
      - "4040:4040"  
      - "7077:7077" 

  spark-worker:
    container_name: spark-worker
    image: docker.io/bitnami/spark:latest
    environment:
      - SPARK_MODE=worker
      - SPARK_MASTER_URL=spark://spark:7077
      - SPARK_WORKER_WEBUI_PORT=8081 
    ports:
      - "8081:8081" 

  streaming:
    build: ./streamingapp
    container_name: streaming
    image: streaming
    restart: unless-stopped
    volumes:
      - appdata:/var/www
    depends_on:
      - spark

networks:
  default:
    external:
      name: bde1
volumes:
  appdata:

